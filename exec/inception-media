#!/usr/bin/env bash

function main {
  local shome="${_inception_home:-"$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"}"
  source "$shome/script/profile"
  source inception_common

  set -x

  $INCEPTION clean

  $PLANE virtualbox rebase
  
  $PLANE virtualbox docker image rebase
  $PLANE virtualbox docker image reuse

  $INCEPTION clean

  for a in virtualbox vmware parallels; do
    $PLANE "$a" rebase
    $PLANE "$a" reuse vagrant
  done

  $INCEPTION clean

  for a in virtualbox vmware parallels; do
    $PLANE "$a" recycle
    $PLANE "$a" docker image import
    $PLANE "$a" reuse
  done

  $INCEPTION clean

  for a in virtualbox vmware parallels; do
    $PLANE "$a" recycle
    $PLANE "$a" destroy -f
  done
}

source sub "$BASH_SOURCE" "$@"
