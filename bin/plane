#!/usr/bin/env bash

export INCEPTION_DREAM="${BASH_SOURCE##*/}"

function main {
  local shome="${_inception_home:-"$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"}"
  source "$shome/script/profile"

  source inception_common

  local nm_tier="${BASH_SOURCE##*/}"

  if limbo "$@"; then
    case "${1:-}" in
      build|recycle) 
        case "${INCEPTION_DREAM}/${VAGRANT_DEFAULT_PROVIDER}" in
          plane/virtualbox) limbo swarm primary ;;
          *) limbo swarm node ;;
        esac

        limbo docker ps
        limbo docker images -a
        ;;
    esac
  fi
}

if [[ -z "${VAGRANT_DEFAULT_PROVIDER:-}" ]]; then
  source sub-chain inception virtualbox "$@"
else
  source sub-chain inception "$@"
fi
